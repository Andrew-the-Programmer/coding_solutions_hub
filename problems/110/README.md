W. Заправочный маршрут — База 2024 2 сем. Задание 3. Алгоритмы — Яндекс.КонтестВаше участие в соревновании завершено. Вы можете дорешивать задачи и отправлять решения вне соревнования

# W. Заправочный маршрут

| Ограничение времени | 2 секунды |
| --- | --- |
| Ограничение памяти | 256Mb |
| Ввод | стандартный ввод или input.txt |
| Вывод | стандартный вывод или output.txt |

На космической станции "Скелет" имеется m воздушных труб и n отсеков (обозначенных номерами от 1 до n). Каждая воздушная труба соединяет некоторые два отсека. Более того, станция "Скелет" в такой модели является планарной.
На некоторых отсеках размещены топливные склады, с которыми у команды заключен контракт о сотрудничестве.

В распоряжении команды имеются космические корабли различной вместимости, пилоты которых могут бесплатно заправляться на любом
топливном складе.

Команде требуется отвечать на следующие запросы: может ли корабль вместимости b долететь от топливного склада, расположенного в отсеке x, до топливного склада, расположенного в отсеке y? Известно, что корабль вместимости b не может пролететь более b километров без дозаправки.

Напишите программу, которая бы автоматизировала ответы на подобные запросы.

## Формат ввода

Первая строка входного файла содержит три целых числа n, s и m (2≤ s ≤ n ≤ 2 ⋅ 105, 1≤ m ≤ 2 ⋅ 105) — количество отсеков, количество отсеков с топливными складами и количество воздушных труб.

Вторая строка содержит s попарно различных целых чисел c1,c2, …, cs (1≤ ci ≤ n) — номера отсеков, на которых расположены топливные склады.

Следующие m строк задают воздушные трубы. i-я из этих строк содержит три целых числа ui, vi и di ![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAU8AAAAjCAYAAAAUjIhnAAAJU0lEQVR4Xu2dZcgVTRTHxRbsRsXCblEMRFAxsLATxAYRscEAvyhYiB8EC8HAFtQPBioGqB8M7EAUu7s7zst/eO999547sztbj/d5n/OD5XHP3N39z5ndiTOzay4SBEEQfJOLGwRBEARvpPIUBEEIgFSegiAIAZDKUxAEIQBSeQqCkOP4/fs3tW/fnnLlCl4FBj9SEAQhmzJv3jxq166dVJ6CIAi2nDx5ksqXL0+PHz+WylMQBMGGN2/eUJUqVWjv3r1qXypPQRAEC/r27UtTpkxJ7sdWeW7cuJFOnTrFzSrYum7dOqpYsWKoiwtCEG7dukUjR47k5owgOzwb0JXYMhW/fnz06BGNHTuWKlWqRPnz51d/sQ97gpUrV1KzZs3o+/fvSZvu3GfPnqVVq1ZxcxrpR/7Lnj17aNGiRdxMBw8epEaNGlHbtm1jLwBnJoX/yOl+GT16dHLYlUlkp2cjbn06bDX79ePVq1epZMmS1Lp1azp//jx9/fpV/cV+qVKlVDooVKhQSsPBNydLliyhbdu2pdg4WlWIC/Tq1Yv+/PnDk6hGjRq0c+dO9W/dRaPg8uXLNHDgQBo8eDBPytGIX4gePnxILVq04OaMIDs9G3Hp0+FXsx8//vz5k+rVq0dly5ZV9ZYT7MNev3599TsdpnOj7uvZsyfdvXuXJyXRHjlp0iTav38/Nyt+/PiR/LdXxvxy7tw56tOnj1pCcPjwYZ6cYxG//MfEiRNp+/bt3JwRZKdnI2p9OoJq9uNH3AtInzVrFk9SwI70HTt28CSF27mPHj1KAwYM4OYkaUe+e/eOmjRpws1avDJmC+KqPXr0oM6dO9Px48d5co5F/JLKixcv1L2JeFimk+nPRlT6dESp2UsnerNIP3LkCE9SoNJGOu/1Js7r3HQ0btxYLWnSkXbEhg0baMKECdysxe2iNpw4cYK6dOlC3bt3105M2WDKvMkeFO7oQYMGJdMQhI7yelH75dmzZ9S/f38qUqSIWt82ZswY+vDhAz/EClM+TfYoQS9i7dq13GwkK8uME/a8UdwD4P79+2qGuXDhwlSsWDHq168fPXnyJLQ+HVFpduKls1atWiod4RwdDx48UOm1a9fmSVZMnjyZli9fzs2KNFUjRoywHhZ5ZcwEusMdOnSg3r17q659WEw6TPagoDXF+RYvXsyTaOnSpTRkyBBu9kVcfoGuixcv0uvXr2n48OHK5lyu4ReTX032KHj79i01bNgwZUhnQ9xlZiKoL6K8BxDzq1y5MpUuXVqd9/Pnz3TgwAHq1KlTYH06otTM8dKJRgHpmCTS8eXLF5VetGhRnmQFhvvORtdJmqqmTZvSlStXuFmLV8Y49+7dozZt2qheEILIUWHSYbKDjh07cpMniAPjfNWrV08ZOiK4XLNmTdXycmyuE7dfdu3albTdvHlT2apVq+b4pT9MfjXZgY0fpk6dSi1bttRuWHpStWrVFBt8dubMGX6aFOIqMy/cfKEjjntgxowZSgMaCSdYhuOmzzb/cWjmuOkEuXPnVummUA7sSM+TJw9PsuLatWtq5l9HmipM+ZvG+ByvjHEQT0XAH0OmzZs3069fv/hPAmHSYbIDtJR+wQOHhxDn3LdvX9KeWFqhw+Y6cfvl+fPnSdu3b9+UDWvhgmLyq8kObPxgAj0mzJiaehduxFVmXrj5Qkcc90CdOnWUBqyLdYKhvJs+2/zHoZnjphPE3fNEiKNEiRLcrEhTlS9fPqMQjlfGTDx9+pSmTZumernr1683LiOwxaTDZA8Dhn84Z7du3ZI2LOvCAtywxOUX3iqH9YvpeJM9LOg56dYc2xJnmZkI6oso74ECBQooDZ8+fUqxI/QRVJ+OKDVzvHTGHfNEXYg6UUeaqrx588ZeeSZ4+fIlzZw5U81orVmzxnc8K4FOR6K7zu3AZLfh1atXVLBgQTVcuH37tmrF0TJ9/PiR/zTwdeL0i5vdFt3xcfkbC6sbNGgQeIILZEWZccKeJ4p7wFR5xlVWUWjmeOlBPBLpfmfbbcGoxzRKS1NVvHhx1VW1wStjtmAiY86cOcrp6A1gaOkHtAzQ4SwszDC76TPZbUhMukyfPp1mz57tujohzHXC+sWUf5Pdlrj8DT8ir84Nsc5y5cql2bFhuHj69Gl+Gi1ZVWYJ3HzhhzD3QN26dZUGxLmdJL4mZNJnstsSRjPHTSdIrPNEmerwWufpBV7vxISbjjRVmNFMvM7khVfG/IIYyty5c1UsatmyZdY9YEx+QAd6FQnwhoKbPp0d6whtWks8sDge8WE82NevX+c/SaK7jl+C+sWUf5Md2PggKn97gRga8oyHMSxhy8zGL07cfBGEIPcAeoHQwCeM8M0KN30mu1+CaOa46QQoE8R2UaZYkeEE+7CjEQkaSsBEWPPmzblZkaYKr1HFvVTJCwzRFixYoN5htgFrsaADv8fyjEuXLqklKG76uP3GjRuqe+6Mi7mRWCeItyfc4NcJg1+/mPJvstv6IAp/27Bp0yYVS4uKoGVm6xcnbr4Ig597ILFUqUyZMnTs2DE1eYLhbatWrVz1mexB8aOZ46YzAe4/hGEw83/hwgXV08Vf7MMeZiXAli1baNSoUdysSFOFFgIzaCYSmTFtf4P379+rgkErg9k3LAR2DiN1urgNQ5kKFSqoYaJNK4XF2jiH13CAXyerMJWLyQ5sfRCFv73ALDkqO9sQkg1By8zWL9y3fPsbYDkRXpFEOeElia5duyaXq5l06WxZCfcb33RgYggvf+ArTAgr4S/2TRNJtowfP1414jrSlEAEloX83zEVAhoP26+/2GC6TiYTtQ+AXz/s3r2bxo0bx81ZgklrHH7JREz5z2mgAccKAt3EItB6CS0V1sH9nzHdIPPnz+emUJiuk8lE7QPg1w/4nNidO3e4OUswaY3DL5mIKf85DXz20C1spPUSJgLwjqruk3RhwGp91OTo2dps6DLHgWkIgOHZ6tWrU2xhMF2Hkyl+AVH7ANj6IcGhQ4do2LBh3JwlmLTG4RcnmXIPmPKvI1M0xwHqPrxuikkvE0YPIVCaU1raBMivW0wrJ5AJPsB/Ces2G/43yAS/CFnHwoULU95I02GsPMGKFSsi+zqKINiAAP/QoUO5WRCyDNR5W7du5eY0XCtPQRAEQY9UnoIgCAGQylMQBCEAUnkKgiAEQCpPQRCEAPwDmbjGs0xME+oAAAAASUVORK5CYII=), обозначающие, что i-я труба имеет длину di километров и соединяет отсеки ui и vi. Каждая пара отсеков соединена не более, чем одной трубой.

Следующая строка содержит одно целое число q (1 ≤ q ≤ 2 ⋅ 105) — количество запросов.

Последующие q строк задают запросы: i-я из этих строк содержит три целых числа xi, yi и bi ![](data:image/png;base64,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) — исходную точку маршрута, конечную точку маршрута и вместимость корабля. Гарантируется, что на обоих отсеках xi и yi размещены топливные склады.

## Формат вывода

Выведите q строк, i-я из которых должна содержать ответ на i-й запрос: «YES», в случае, если корабль вместимостью bi сможет добраться от отсека xi до отсека yi, и «NO» в противном случае.

## Пример

| Ввод Скопировать ввод | Вывод Скопировать вывод |
| --- | --- |
| `6 4 5 1 5 2 6 1 3 1 2 3 2 3 4 3 4 5 5 6 4 5 4 1 2 4 2 6 9 1 5 9 6 5 8 ` | `YES YES YES NO ` |

## Примечания

Для решения данной задачи необходимо уметь пользоваться структурой данных DSU aka СНМ (система непересекающихся множеств).
